<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Microsoft Entra ID Group Import - Help</title>
<style>
  body {
    font-family: Arial, sans-serif;
    line-height: 1.6;
    margin: 0;
    padding: 0;
    background: #f9f9f9;
    color: #333;
  }
  header {
    background: #0078d4;
    color: #fff;
    padding: 1rem 2rem;
    text-align: center;
  }
  main {
    padding: 2rem;
    max-width: 900px;
    margin: auto;
    background: #fff;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  h1, h2, h3 {
    color: #0078d4;
  }
  section {
    margin-bottom: 2rem;
  }
  .collapsible {
    background-color: #e7f1fc;
    color: #0078d4;
    cursor: pointer;
    padding: 0.75rem 1rem;
    width: 100%;
    border: none;
    text-align: left;
    outline: none;
    font-size: 1rem;
    margin-top: 0.5rem;
    border-radius: 5px;
  }
  .active, .collapsible:hover {
    background-color: #d0e4f8;
  }
  .content {
    padding: 0 1rem;
    display: none;
    overflow: hidden;
    background-color: #f1f9ff;
    border-left: 3px solid #0078d4;
    margin-bottom: 1rem;
    border-radius: 5px;
  }
  ul {
    padding-left: 1.5rem;
  }
  code {
    background: #f4f4f4;
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
  }
  .copy-button, .download-button {
    background-color: #0078d4;
    color: #fff;
    padding: 0.5rem 1rem;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-top: 0.5rem;
    margin-right: 0.5rem;
  }
  .copy-button:hover, .download-button:hover {
    background-color: #005a9e;
  }
  .message {
    color: green;
    margin-top: 0.5rem;
    font-size: 0.9rem;
  }
  textarea {
    width: 100%;
    min-height: 100px;
    margin-top: 0.5rem;
    padding: 0.5rem;
    font-family: monospace;
    border-radius: 5px;
    border: 1px solid #ccc;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 0.5rem;
  }
  th, td {
    border: 1px solid #0078d4;
    padding: 0.5rem;
    text-align: left;
  }
  th {
    background-color: #e7f1fc;
  }
</style>
</head>
<body>

<header>
  <h1>Microsoft Entra ID Group Import - Help</h1>
</header>

<main>
  <section>
    <h2>Overview</h2>
    <p>This web app generates properly formatted CSV files for bulk importing members into Microsoft Entra ID (formerly Azure AD) groups. It ensures compliance with Microsoft’s CSV requirements and simplifies the import process.</p>
  </section>

  <section>
    <h2>Features</h2>
    <ul>
      <li>Generates Microsoft Entra-compliant CSV files</li>
      <li>Validates that at least 2 members are included</li>
      <li>Creates timestamped download folders</li>
      <li>Preview functionality before downloading</li>
      <li>Simple, user-friendly interface</li>
    </ul>
  </section>

  <section>
    <h2>CSV Template & Live Preview</h2>
    <p>Paste your email addresses or object IDs below, one per line. The live preview table shows how your CSV will look.</p>
    <textarea id="memberInput" placeholder="Enter one email or object ID per line..."></textarea>
    <div style="margin-top:0.5rem;">
      <button class="copy-button" onclick="copyCSV()">Copy CSV Template</button>
      <button class="download-button" onclick="downloadCSV()">Download CSV</button>
    </div>
    <div id="message" class="message"></div>

    <table id="previewTable">
      <thead>
        <tr>
          <th>Member object ID or user principal name [memberObjectIdOrUpn]</th>
        </tr>
      </thead>
      <tbody>
        <!-- Live preview rows go here -->
      </tbody>
    </table>

    <pre id="csv-template" style="display:none;">
version:v1.0
Member object ID or user principal name [memberObjectIdOrUpn] Required
user1@domain.com
user2@domain.com
    </pre>
  </section>

  <section>
    <h2>How to Upload to Microsoft Entra ID</h2>
    <ul>
      <li>Sign in to <a href="https://entra.microsoft.com" target="_blank">Microsoft Entra admin center</a> with Groups Administrator permissions</li>
      <li>Navigate to <strong>Identity → Groups → All groups</strong> and open your group</li>
      <li>Click <strong>Members → Bulk operations → Import members</strong></li>
      <li>Upload the CSV file generated by the web app</li>
      <li>Submit the import and monitor progress under <strong>Bulk operation results</strong></li>
    </ul>
  </section>

  <section>
    <h2>CSV Requirements</h2>
    <ul>
      <li>First two rows must not be modified:
        <ul>
          <li>Row 1: <code>version:v1.0</code></li>
          <li>Row 2: <code>Member object ID or user principal name [memberObjectIdOrUpn] Required</code></li>
        </ul>
      </li>
      <li>Each member must be either a User Principal Name or Member Object ID</li>
      <li>Minimum 2 members required</li>
    </ul>
  </section>

  <section>
    <h2>Best Practices</h2>
    <ul>
      <li>Preview CSV before uploading</li>
      <li>Start with a small test batch (2–5 members)</li>
      <li>Keep a backup of your CSV file</li>
      <li>For large imports, split into batches of 500–1000 members</li>
      <li>Verify emails or object IDs before importing</li>
      <li>Check bulk operation results after submission</li>
    </ul>
  </section>

  <section>
    <h2>Resources</h2>
    <ul>
      <li><a href="https://learn.microsoft.com/en-us/entra/identity/users/groups-bulk-import-members" target="_blank">Microsoft Documentation: Bulk Import Members</a></li>
      <li><a href="https://learn.microsoft.com/en-us/entra/fundamentals/bulk-operations-service-limitations" target="_blank">Bulk Operations Service Limitations</a></li>
      <li><a href="https://entra.microsoft.com" target="_blank">Microsoft Entra Admin Center</a></li>
    </ul>
  </section>

  <footer style="text-align:center; margin-top:2rem; font-size:0.9rem; color:#555;">
    Last Updated: November 2025
  </footer>
</main>

<script>
  // Live CSV preview
  const memberInput = document.getElementById("memberInput");
  const previewTableBody = document.querySelector("#previewTable tbody");
  const message = document.getElementById("message");

  memberInput.addEventListener("input", updatePreview);

  function updatePreview() {
    const lines = memberInput.value.split("\n").filter(line => line.trim() !== "");
    previewTableBody.innerHTML = "";
    lines.forEach(line => {
      const row = document.createElement("tr");
      const cell = document.createElement("td");
      cell.textContent = line;
      row.appendChild(cell);
      previewTableBody.appendChild(row);
    });
  }

  // Copy CSV Template
  function copyCSV() {
    const csvTemplate = document.getElementById("csv-template").innerText;
    navigator.clipboard.writeText(csvTemplate).then(() => {
      message.innerText = "CSV template copied to clipboard!";
      setTimeout(() => message.innerText = "", 3000);
    });
  }

  // Download CSV
  function downloadCSV() {
    const lines = memberInput.value.split("\n").filter(line => line.trim() !== "");
    if (lines.length < 2) {
      message.innerText = "Please enter at least 2 members before downloading!";
      setTimeout(() => message.innerText = "", 3000);
      return;
    }
    const csvContent = ["version:v1.0", "Member object ID or user principal name [memberObjectIdOrUpn] Required", ...lines].join("\n");
    const blob = new Blob([csvContent], { type: "text/csv" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "GroupImportMembers.csv";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    message.innerText = "CSV file downloaded!";
    setTimeout(() => message.innerText = "", 3000);
  }
</script>

</body>
</html>
